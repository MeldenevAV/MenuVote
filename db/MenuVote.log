/*C3*/SET SCHEMA PUBLIC
DISCONNECT
/*C4*/SET SCHEMA PUBLIC
DROP TABLE restaurant_vote IF EXISTS
DROP TABLE  menu_items IF EXISTS
DROP TABLE  menus IF EXISTS
DROP TABLE restaurants IF EXISTS
DROP TABLE user_roles IF EXISTS
DROP TABLE users IF EXISTS
DROP SEQUENCE global_seq IF EXISTS
CREATE SEQUENCE GLOBAL_SEQ AS INTEGER START WITH 100000
CREATE TABLE users\u000a(\u000a  id               INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  name             VARCHAR(255)            NOT NULL,\u000a  email            VARCHAR(255)            NOT NULL,\u000a  password         VARCHAR(255)            NOT NULL,\u000a  registered       TIMESTAMP DEFAULT now() NOT NULL,\u000a  enabled          BOOLEAN DEFAULT TRUE    NOT NULL\u000a)
CREATE UNIQUE INDEX users_unique_email_idx ON USERS (email)
CREATE TABLE user_roles\u000a(\u000a  user_id INTEGER NOT NULL,\u000a  role    VARCHAR(255),\u000a  CONSTRAINT user_roles_idx UNIQUE (user_id, role),\u000a  FOREIGN KEY (user_id) REFERENCES USERS (id) ON DELETE CASCADE\u000a)
CREATE TABLE restaurants\u000a(\u000a  id          INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  reastaurant_name VARCHAR(255) NOT NULL\u000a)
CREATE TABLE menus\u000a(\u000a  id            INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  restaurant_id INTEGER NOT NULL,\u000a  menu_date     Date    NOT NULL,\u000a  CONSTRAINT restaurant_menu_day_idx UNIQUE (restaurant_id, id, menu_date),\u000a  FOREIGN KEY (restaurant_id) REFERENCES restaurants (id) ON DELETE CASCADE\u000a)
CREATE TABLE menu_items\u000a(\u000a  id            INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  menu_id INTEGER NOT NULL,\u000a  description     VARCHAR(255) NOT NULL,\u000a  price   FLOAT NOT NULL,\u000a  CONSTRAINT menu_description_idx UNIQUE (menu_id, description),\u000a  FOREIGN KEY (menu_id) REFERENCES menus (id) ON DELETE CASCADE\u000a)
CREATE TABLE restaurant_vote\u000a(\u000a  id            INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,\u000a  restaurant_id INTEGER NOT NULL,\u000a  user_id       INTEGER NOT NULL,\u000a  vote_date     Date NOT NULL,\u000a  vote_time     TIME NOT NULL,\u000a  CONSTRAINT restaurant_user_date_idx UNIQUE (restaurant_id, user_id, vote_date),\u000a  FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE\u000a)
DISCONNECT
/*C5*/SET SCHEMA PUBLIC
DISCONNECT
/*C6*/SET SCHEMA PUBLIC
set schema PUBLIC
DISCONNECT
